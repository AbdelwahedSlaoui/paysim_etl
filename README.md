# PaySim ETL Pipeline

An ETL pipeline for processing and analyzing financial transaction data, built with industry-standard tools and commonly used in banking and financial services.

## Dataset Overview

The pipeline processes synthetic financial transaction data generated by PaySim, a simulator that models mobile money transactions based on patterns from real financial logs. Key characteristics:

- Transaction types: CASH-IN, CASH-OUT, DEBIT, PAYMENT, and TRANSFER
- Features include transaction amount, sender/receiver details, and account balances
- Fraud detection flags for suspicious activities
- Sample size: ~6.3M records representing one month of transactions

> **Data Structure**: Each transaction record captures the complete lifecycle of a financial operation, including initial balances, transaction details, and resulting account states.

## Technical Architecture

**Core Processing**
- **PySpark**: Distributed computing framework for scalable data processing
- **Prefect**: Modern workflow orchestration with robust error handling
- **Great Expectations**: Data quality and validation framework
- **DuckDB**: Analytical database optimized for complex queries

**Development & Quality**
- **Python 3.11**: Latest stable version with type hints support
- **pytest**: Comprehensive testing framework
- **Black/isort/ruff**: Code formatting and linting
- **Git/GitHub**: Version control

> **Architecture Pattern**: Followed the medallion architecture (Bronze → Silver → Gold) common in financial data lakes, ensuring data quality and traceability at each stage.

## Business Metrics & Insights

Our gold layer analytics focus on key behavioral patterns that help understand customer transaction habits:

### Transaction Patterns
Based on the output data, it is observed:

1. **Payment Behavior**
   - High-frequency, lower-value payment flows (33.81% of transactions, avg 13.86K)
   - Significant cash-out activity (21.99% of total volume)

2. **Balance Patterns**
   - Average balance changes: -25.84% (PAYMENT), -47.97% (CASH_OUT)
   - Volume-to-balance ratios indicating transaction velocity
   - Zero balance patterns highlighting account usage

3. **Size Distribution**
   - Large transaction thresholds varying by type
   - Median amounts showing typical customer behavior
   - Transaction count distribution across types

## Quality & Security Framework

### Data Quality & Consistency
1. **Schema Validation**
   - Type checking in `bronze.py`
   - Null handling and data cleaning in `silver.py`
   - Business rule validation in `gold.py`

2. **Great Expectations Integration**
   ```python
   # From ge_suite.py
   suite.add_expectation(
       ExpectationConfiguration(
           expectation_type="expect_column_values_to_be_in_set",
           kwargs={
               "column": "type",
               "value_set": ["PAYMENT", "TRANSFER", "CASH_OUT", "CASH_IN", "DEBIT"]
           }
       )
   )
   ```

### Pipeline Validation

**Automated Testing**
- Unit tests for each transformation layer (`test_bronze.py`, `test_silver.py`, `test_gold.py`)
- Integration tests for the complete pipeline (`test_flow.py`)
- Data quality tests using Great Expectations (`test_ge_suite.py`)

**Continuous Integration**
- Automated testing through GitHub Actions
- Code quality checks (Black, isort, ruff)
- Type checking with mypy

### Version Control & Security

1. **Git Workflow**
   - Feature branches for development
   - Pull request reviews
   - Version tagging for releases

2. **Security Measures**
   - Authentication, audit and data integrity with `core_security.py`
   - Audit logging in `log_config.py`